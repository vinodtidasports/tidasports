(()=>{"use strict";var __webpack_require__={n:module=>{var getter=module&&module.__esModule?()=>module.default:()=>module;return __webpack_require__.d(getter,{a:getter}),getter},d:(exports,definition)=>{for(var key in definition)__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)&&Object.defineProperty(exports,key,{enumerable:!0,get:definition[key]})},o:(obj,prop)=>Object.prototype.hasOwnProperty.call(obj,prop)};const external_React_namespaceObject=window.React,external_wp_element_namespaceObject=window.wp.element,external_lodash_namespaceObject=window.lodash,external_wp_components_namespaceObject=window.wp.components,external_wp_i18n_namespaceObject=window.wp.i18n,external_moment_namespaceObject=window.moment;var external_moment_default=__webpack_require__.n(external_moment_namespaceObject);function formatDate(date){return external_moment_default()(date).format("MMM DD, YYYY")}function hoursOfDayCombo(selectedTime,updateSelectedTime,timeFrameIndex,selectIndex){const options=[];for(var hour=0;hour<24;hour++)options.push({label:external_moment_default()().startOf("day").add(hour,"hour").format("h:mma"),value:hour});return(0,external_React_namespaceObject.createElement)(external_wp_components_namespaceObject.SelectControl,{key:`${timeFrameIndex}-${selectIndex}`,value:selectedTime,onChange:updateSelectedTime,className:"wb__sap__time-frame-hours-selector",options})}const store_availability_popover=function(props){const[isPopoverVisible,setPopoverVisible]=(0,external_wp_element_namespaceObject.useState)(!0),[startDate,setStartDate]=(0,external_wp_element_namespaceObject.useState)(props.selectedDate||new Date),[needsEndDate,setNeedsEndDate]=(0,external_wp_element_namespaceObject.useState)(!1),[endDate,setEndDate]=(0,external_wp_element_namespaceObject.useState)(props.selectedDate||new Date),[isDatePickerVisible,setDatePickerVisible]=(0,external_wp_element_namespaceObject.useState)(!1),[availabilityTime,setAvailabilityTime]=(0,external_wp_element_namespaceObject.useState)("1"),[availabilityTimeFrames,setAvailabilityTimeFrames]=(0,external_wp_element_namespaceObject.useState)([]),[frequency,setFrequency]=(0,external_wp_element_namespaceObject.useState)("1"),[repeatDaysOfWeek,setRepeatDaysOfWeek]=(0,external_wp_element_namespaceObject.useState)(),selectedDayOfWeek=external_moment_default()(props.selectedDate).format("dddd"),selectedDay=external_moment_default()(props.selectedDate).format("MMMM D");function selectStartDate(){setDatePickerVisible(!isDatePickerVisible),updateDate=setStartDate}function selectEndDate(){setNeedsEndDate(!0),setDatePickerVisible(!isDatePickerVisible),updateDate=setEndDate}function changeAvailabilityTime(newAvailabilityTime){setAvailabilityTime(newAvailabilityTime),0===availabilityTimeFrames.length&&(availabilityTimeFrames.push(["0","0"]),setAvailabilityTimeFrames(availabilityTimeFrames))}function changeFrequency(newFrequency){setFrequency(newFrequency)}function changeRepeatDayOfWeek(event){const dayOfWeek=parseInt(event.target.value);let selectedDays=repeatDaysOfWeek||[];selectedDays.includes(dayOfWeek)?selectedDays=selectedDays.filter((day=>day!==dayOfWeek)):selectedDays.push(dayOfWeek),setRepeatDaysOfWeek(selectedDays.slice())}function closePopover(){isDatePickerVisible||setPopoverVisible(!1)}return isPopoverVisible&&(0,external_React_namespaceObject.createElement)("div",{className:"wb__sap__container"},(0,external_React_namespaceObject.createElement)(external_wp_components_namespaceObject.Popover,{position:"middle center",onClickOutside:closePopover,focusOnMount:!1},(0,external_React_namespaceObject.createElement)("div",{className:"wb__sap"},(0,external_React_namespaceObject.createElement)("h4",{className:"wb__sap__heading"},(0,external_wp_i18n_namespaceObject.__)("Edit Availability","woocommerce-bookings")),(0,external_React_namespaceObject.createElement)("div",{className:"wb__sap__start-end-dates wb__sap__row"},(0,external_React_namespaceObject.createElement)(external_wp_components_namespaceObject.TextControl,{className:"wb__sap__start-date",label:(0,external_wp_i18n_namespaceObject.__)("Start Date","woocommerce-bookings"),onClick:selectStartDate,value:formatDate(startDate)}),needsEndDate?(0,external_React_namespaceObject.createElement)(external_wp_components_namespaceObject.TextControl,{className:"wb__sap__end-date",label:(0,external_wp_i18n_namespaceObject.__)("End Date","woocommerce-bookings"),onClick:selectEndDate,value:formatDate(endDate)}):(0,external_React_namespaceObject.createElement)("span",{className:"wb__sap__add-end-date",onClick:selectEndDate},(0,external_wp_i18n_namespaceObject.__)("Add end date","woocommerce-bookings"))),(0,external_React_namespaceObject.createElement)("div",{className:"wb__sap__time wb__sap__row"},(0,external_React_namespaceObject.createElement)(external_wp_components_namespaceObject.SelectControl,{label:(0,external_wp_i18n_namespaceObject.__)("Time","woocommerce-bookings"),className:"wb__sap__time-selector",value:availabilityTime,onChange:changeAvailabilityTime,options:[{label:(0,external_wp_i18n_namespaceObject.__)("Available all day","woocommerce-bookings"),value:"1"},{label:(0,external_wp_i18n_namespaceObject.__)("Available at specific hours","woocommerce-bookings"),value:"2"}]}),"2"===availabilityTime&&function(availabilityTimeFrames,setAvailabilityTimeFrames){const timeFrames=[];function changeTimeFrame(timeFrameIndex,comboIndex){return function(newTime){availabilityTimeFrames[timeFrameIndex][comboIndex]=newTime,setAvailabilityTimeFrames(availabilityTimeFrames.slice())}}function addAnotherTimeFrame(){availabilityTimeFrames.push(["0","0"]),setAvailabilityTimeFrames(availabilityTimeFrames.slice())}for(var timeFrameIndex=0;timeFrameIndex<availabilityTimeFrames.length;timeFrameIndex++){const timeFrame=(0,external_React_namespaceObject.createElement)("div",{key:timeFrameIndex,className:"wb__sap__time-frame wb__sap__row"},hoursOfDayCombo(availabilityTimeFrames[timeFrameIndex][0],changeTimeFrame(timeFrameIndex,0),timeFrameIndex,0),(0,external_React_namespaceObject.createElement)("span",null,"â€”"),hoursOfDayCombo(availabilityTimeFrames[timeFrameIndex][1],changeTimeFrame(timeFrameIndex,1),timeFrameIndex,1));timeFrames.push(timeFrame)}return timeFrames.push((0,external_React_namespaceObject.createElement)("div",{key:"add-more-times",className:"wb__sap__add-new-time-frame",onClick:addAnotherTimeFrame},(0,external_wp_i18n_namespaceObject.__)("Add more times","woocommerce-bookings"))),timeFrames}(availabilityTimeFrames,setAvailabilityTimeFrames)),(0,external_React_namespaceObject.createElement)("div",{className:"wb__sap__frequency wb__sap__row"},(0,external_React_namespaceObject.createElement)(external_wp_components_namespaceObject.SelectControl,{label:(0,external_wp_i18n_namespaceObject.__)("Frequency","woocommerce-bookings"),className:"wb__sap__frequency-selector",value:frequency,onChange:changeFrequency,options:[{label:(0,external_wp_i18n_namespaceObject.__)("Does not repeat","woocommerce-bookings"),value:"1"},{label:(0,external_wp_i18n_namespaceObject.sprintf)((0,external_wp_i18n_namespaceObject.__)("Every %s","woocommerce-bookings"),selectedDayOfWeek),value:"2"},{label:(0,external_wp_i18n_namespaceObject.sprintf)((0,external_wp_i18n_namespaceObject.__)("Anually on %s","woocommerce-bookings"),selectedDay),value:"3"},{label:(0,external_wp_i18n_namespaceObject.__)("On specific days of the week","woocommerce-bookings"),value:"4"},{label:(0,external_wp_i18n_namespaceObject.__)("On specific dates","woocommerce-bookings"),value:"5"}]}),"4"===frequency&&(0,external_React_namespaceObject.createElement)("div",{className:"wb__sap__frequency-days-of-week wb__sap__row"},(0,external_React_namespaceObject.createElement)("span",null,(0,external_wp_i18n_namespaceObject.__)("Repeats on:","woocommerce-bookings")),(0,external_React_namespaceObject.createElement)("ul",{className:"wb__sap__days-of-week-selector"},function(changeRepeatDayOfWeek,repeatDaysOfWeek){const daysOfWeek=[];for(var dayIndex=0;dayIndex<7;dayIndex++){const day=external_moment_default()().startOf("week").add(dayIndex,"days"),dayOfWeek=day.weekday(),dayName=day.format("dd"),classNames=["wb__sap__day-of-week-button"];(repeatDaysOfWeek||[]).includes(dayOfWeek)&&classNames.push("selected"),daysOfWeek.push((0,external_React_namespaceObject.createElement)("li",{key:dayIndex},(0,external_React_namespaceObject.createElement)("button",{className:classNames.join(" "),onClick:changeRepeatDayOfWeek,value:dayOfWeek,"data-day":dayName},dayName)))}return daysOfWeek}(changeRepeatDayOfWeek,repeatDaysOfWeek)))),(0,external_React_namespaceObject.createElement)("div",{className:"wb__sap__actions wb__sap__row"},(0,external_React_namespaceObject.createElement)(external_wp_components_namespaceObject.Button,{className:"wb__sap__cancel",isTertiary:!0,isLink:!0,onClick:closePopover},(0,external_wp_i18n_namespaceObject.__)("Cancel","woocommerce-bookings")),(0,external_React_namespaceObject.createElement)(external_wp_components_namespaceObject.Button,{className:"wb__sap__apply",isDefault:!0,isPrimary:!0},(0,external_wp_i18n_namespaceObject.__)("Apply","woocommerce-bookings"))))),isDatePickerVisible&&(0,external_React_namespaceObject.createElement)(external_wp_components_namespaceObject.Popover,{className:"wb__sap_date-picker",position:"middle center",onClickOutside:()=>setDatePickerVisible(!1),focusOnMount:!1},(0,external_React_namespaceObject.createElement)(external_wp_components_namespaceObject.DatePicker,{currentDate:startDate,onChange:date=>{setDatePickerVisible(!1),updateDate(date)}})))};let popoverContainer;const storeAvailabilityDays=document.getElementsByClassName("wc-bookings__store-availability-day");null!==storeAvailabilityDays&&(0,external_lodash_namespaceObject.forEach)(storeAvailabilityDays,(storeAvailabilityDay=>{storeAvailabilityDay.addEventListener("click",(()=>{const date=new Date(1e3*parseInt(storeAvailabilityDay.dataset.timestamp));popoverContainer&&document.body.removeChild(popoverContainer),popoverContainer=document.createElement("div"),document.body.appendChild(popoverContainer),(0,external_wp_element_namespaceObject.render)((0,external_React_namespaceObject.createElement)(store_availability_popover,{selectedDate:date}),popoverContainer)}))}))})();
//# sourceMappingURL=admin-store-availability.js.map