{"version":3,"file":"admin-time-picker.js","mappings":"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","sources":["webpack://woocommerce-bookings/./src/js/bookings-lib.js","webpack://woocommerce-bookings/external window \"jQuery\"","webpack://woocommerce-bookings/webpack/bootstrap","webpack://woocommerce-bookings/webpack/runtime/compat get default export","webpack://woocommerce-bookings/webpack/runtime/define property getters","webpack://woocommerce-bookings/webpack/runtime/hasOwnProperty shorthand","webpack://woocommerce-bookings/./src/js/time-picker.js"],"sourcesContent":["/* globals: booking_form_params */\nimport $ from 'jquery';\n\n/**\n * Returns the hour offset between the client and the server.\n *\n * @param {*} referenceDate at which to compute offset.\n * @return {number} Number of hours between server and client.\n */\nexport function get_client_server_timezone_offset_hrs( referenceDate ) {\n\tif ( ! booking_form_params.timezone_conversion ) {\n\t\treturn 0;\n\t}\n\n\tlet reference_time = moment( referenceDate );\n\tconst client_offset = reference_time.utcOffset();\n\treference_time.tz( booking_form_params.server_timezone );\n\tconst server_offset = reference_time.utcOffset();\n\n\treturn ( client_offset - server_offset ) / 60.0;\n}\n\nexport function display_error( errorMessage = booking_form_params.i18n_request_failed, after = '#wc-bookings-booking-form' ) {\n\t// Remove 'active' class from old notices.\n\t$( '.woocommerce-error.wc-bookings-notice' ).removeClass( 'active' );\n\n\t// Create a new error notice element.\n\tlet errorMessageHTML = document.createElement( 'p' );\n\terrorMessageHTML.setAttribute( 'class', 'woocommerce-error wc-bookings-notice active' );\n\terrorMessageHTML.setAttribute( 'style', 'display: none;' );\n\terrorMessageHTML.textContent = errorMessage;\n\t$( errorMessageHTML ).insertAfter( after );\n\n\t// Show a new notice and hide old ones.\n\t$( '.woocommerce-error.wc-bookings-notice.active' ).slideDown( {\n\t\tcomplete: function() {\n\t\t\t$( '.woocommerce-error.wc-bookings-notice:not(.active)' ).slideUp();\n\t\t}\n\t} );\n}\n","module.exports = window[\"jQuery\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","/**\n * External dependencies\n */\nimport jQuery from \"jquery\";\n\n/**\n * Internal dependencies\n */\nimport { get_client_server_timezone_offset_hrs, display_error } from './bookings-lib';\n\njQuery( document ).ready( function( $ ) {\n\tvar local_timezone = moment.tz.guess() || booking_form_params.server_timezone;\n\n\tif ( booking_form_params.timezone_conversion ) {\n\t\t$( '.wc-bookings-date-picker-timezone' ).text( local_timezone.replace( '_', ' ' ) );\n\t\t$( '[name=\"wc_bookings_field_start_date_local_timezone\"]' ).val( local_timezone );\n\t}\n\n\t$( '.block-picker' ).on( 'click', 'a', function() {\n\t\tconst bookingform = $(this).closest('form');\n\n\t\t// Don't enable this event for month duration.\n\t\tif ( bookingform.find( '[name=\"wc_bookings_field_start_date_yearmonth\"]' ).length ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar value        = $(this).data( 'value' );\n\t\tvar block_picker = $(this).closest( 'ul' );\n\n\t\tset_selected_time( block_picker, value );\n\t\treturn false;\n\t} );\n\n\tfunction set_selected_time( block_picker, value ) {\n\t\tvar submit_button = block_picker.closest( 'form' ).find( '.wc-bookings-booking-form-button' );\n\t\tif ( undefined === value ) {\n\t\t\tsubmit_button.addClass( 'disabled' );\n\t\t\treturn;\n\t\t}\n\n\t\tvar selected_block = block_picker.find( '[data-value=\"' + value + '\"]' );\n\n\t\tif ( undefined === selected_block.data( 'value' ) ) {\n\t\t\tsubmit_button.addClass( 'disabled' );\n\t\t\treturn;\n\t\t}\n\n\t\tvar target = block_picker.closest( 'div' ).find( 'input' );\n\n\t\ttarget.val( value ).trigger( 'change' );\n\t\tblock_picker.closest( 'ul' ).find( 'a' ).removeClass( 'selected' );\n\t\tselected_block.addClass( 'selected' );\n\t\tsubmit_button.removeClass( 'disabled' );\n\t}\n\n\tfunction time_picker_reset_selected( block_picker ) {\n\t\tblock_picker.closest( 'ul' ).find( 'a' ).removeClass( 'selected' );\n\t}\n\n\twc_bookings_booking_form.time_picker_reset_selected = time_picker_reset_selected;\n\n\t$( '.wc-bookings-booking-form' ).on( 'change', '#wc-bookings-form-start-time', function() {\n\t\tvar value = $( this ).val(),\n\t\t\tbookingForm = $( this ).closest( 'form' ),\n\t\t\tid = $( this ).parents( '.wc-bookings-start-time-container' ).data( 'productId' ),\n\t\t\tblocks = $( this ).parents( '.wc-bookings-start-time-container' ).data( 'blocks' ),\n\t\t\tformField = $( this ).parents( '.form-field' ).eq( 0 );\n\n\t\t// Disable end time dropdown.\n\t\t$( '#wc-bookings-form-end-time' ).attr( 'disabled', 'disabled' );\n\n\t\t// Set the end time dropdown opacity.\n\t\t$( '#wc-bookings-form-end-time' ).css( 'opacity', '0.5' );\n\n\t\t// Hide the cost as a reset.\n\t\t$( this ).closest( 'form' ).find( '.wc-bookings-booking-cost' ).html( '' ).hide();\n\n\t\tif ( '0' === value ) {\n\t\t\t$( this ).closest( 'form' ).find( '.wc-bookings-booking-form-button' ).addClass( 'disabled' );\n\t\t\treturn false;\n\t\t}\n\n\t\t// Disable the Book button.\n\t\tbookingForm.find( '.wc-bookings-booking-form-button' ).addClass( 'disabled' );\n\n\t\tvar resource_id = bookingForm.find( '#wc_bookings_field_resource' ).val();\n\n\t\tvar year_str = bookingForm.find( 'input.booking_date_year' ).val();\n\t\tvar year  = parseInt( year_str, 10 );\n\t\tvar month_str = bookingForm.find( 'input.booking_date_month' ).val();\n\n\t\tvar month  = parseInt( month_str, 10 );\n\t\tvar day_str = bookingForm.find( 'input.booking_date_day' ).val();\n\t\tvar day  = parseInt( day_str, 10 );\n\n\t\tvar person_qty = bookingForm.find( '#wc_bookings_field_persons' ).val();\n\n\t\tvar date_str =  year_str + '-' + month_str + '-' + day_str;\n\n\t\tif ( ! year || ! month || ! day ) {\n\t\t\treturn;\n\t\t}\n\n\t\txhr = $.ajax( {\n\t\t\ttype: \t\t'POST',\n\t\t\turl: \t\tbooking_form_params.ajax_url,\n\t\t\tdata: \t\t{\n\t\t\t\taction: 'wc_bookings_get_end_time_html',\n\t\t\t\tsecurity: booking_form_params.nonce.get_end_time_html,\n\t\t\t\tstart_date_time: value,\n\t\t\t\tproduct_id: id,\n\t\t\t\tblocks: blocks,\n\t\t\t\tresource_id: resource_id,\n\t\t\t\tperson_qty,\n\t\t\t},\n\t\t\tsuccess: function( response ) {\n\t\t\t\tbookingForm.find( '.wc-bookings-end-time-container' ).replaceWith( response );\n\t\t\t\toffset_block_times_for_end_time( date_str );\n\t\t\t\tformField.find( 'input.required_for_calculation' ).val( value );\n\t\t\t},\n\t\t\tdataType: \t\"html\"\n\t\t} );\n\n\t\treturn false;\n\t} );\n\n\t$( '.wc-bookings-booking-form' ).on( 'change', '#wc-bookings-form-end-time', function() {\n\t\t// Hide the cost as a reset.\n\t\t$( '.wc-bookings-booking-cost' ).html( '' ).hide();\n\n\t\tvar value        = $( this ).val(),\n\t\t\tblock_picker = $( this );\n\n\t\t$( this ).parents( '.wc-bookings-booking-form' ).find( '.wc_bookings_field_duration' ).val( value );\n\n\t\tvar submit_button = block_picker.closest( 'form' ).find( '.wc-bookings-booking-form-button' );\n\n\t\tif ( undefined === value || '0' === value || '0' === $( this ).parents( '.wc-bookings-booking-form' ).find( '#wc-bookings-form-start-time' ).val() ) {\n\t\t\tsubmit_button.addClass( 'disabled' );\n\t\t\treturn;\n\t\t}\n\n\t\tblock_picker.parents( '.form-field' ).eq( 0 ).find( 'input.required_for_calculation' ).trigger( 'change' );\n\t\tsubmit_button.removeClass( 'disabled' );\n\t} );\n\n\tfunction set_selected_customer_time( block_picker, value ) {\n\t\tvar submit_button = block_picker.closest( 'form' ).find( '.wc-bookings-booking-form-button' );\n\n\t\tif ( undefined === value || '0' === value ) {\n\t\t\tsubmit_button.addClass( 'disabled' );\n\t\t\treturn;\n\t\t}\n\n\t\tvar target = block_picker.parents( '.form-field' ).eq( 0 ).find( 'input.required_for_calculation' );\n\n\t\ttarget.val( value ).trigger( 'change' );\n\t\tsubmit_button.removeClass( 'disabled' );\n\t}\n\n\t$('.wc_bookings_field_duration').on( 'change', function() {\n\t\tif ( ! [ 'hour', 'minute' ].includes( wc_bookings_booking_form.get_booking_duration_unit($(this)) ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tshow_available_time_blocks( this );\n\t});\n\n\t$('#wc_bookings_field_resource').on( 'change', function() {\n\t\tconst duration_unit = wc_bookings_booking_form.get_booking_duration_unit($(this));\n\n\t\tif ( 'month' === duration_unit ) {\n\t\t\tshow_available_month_blocks( this );\n\t\t} else if ( ! [ 'hour', 'minute' ].includes( duration_unit ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\ttime_picker_reset_selected( $( '.wc-bookings-booking-form' ).find( '.block-picker' ) );\n\t});\n\n\t$('.wc-bookings-booking-form fieldset').on( 'date-selected', function() {\n\t\t$( '.wc_bookings_field_duration' ).val( 1 );\n\n\t\tif ( ! [ 'hour', 'minute' ].includes( wc_bookings_booking_form.get_booking_duration_unit($(this)) ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tshow_available_time_blocks( this );\n\t});\n\n\tvar xhr;\n\n\tfunction show_available_month_blocks( element ) {\n\t\tvar $form = $( element ).closest( 'form' );\n\t\tvar form_val = $form.serialize();\n\t\tvar block_picker = $( element ).closest( 'div' ).find( '.block-picker' );\n\n\t\tblock_picker.closest( 'div' ).block( { message: null, overlayCSS: { background: '#fff', backgroundSize: '16px 16px', opacity: 0.6 } } ).show();\n\n\t\tvar xhr = $.ajax( {\n\t\t\ttype: 'POST',\n\t\t\turl: booking_form_params.ajax_url,\n\t\t\tdata: {\n\t\t\t\taction: 'wc_bookings_get_booking_blocks',\n\t\t\t\tform: form_val,\n\t\t\t\tsecurity: booking_form_params.nonce.show_available_month_blocks,\n\t\t\t},\n\t\t\tsuccess: function( result ) {\n\t\t\t\tresult = JSON.parse( result );\n\n\t\t\t\t// Check for failure.\n\t\t\t\tif ( ! result.success ) {\n\t\t\t\t\talert( result.data );\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tblock_picker.closest( 'div' ).unblock();\n\t\t\t\t$( '.block-picker' ).html( result.data );\n\t\t\t},\n\t\t\terror: function( jqXHR, exception ) {\n\t\t\t\tif ( 'abort' === exception ) {\n\t\t\t\t\treturn; // Assuming the date is changed very quickly.\n\t\t\t\t}\n\n\t\t\t\tdisplay_error();\n\t\t\t},\n\t\t\tdataType: 'html'\n\t\t} );\n\t}\n\n\tfunction show_available_time_blocks( element ) {\n\t\tvar $form               = $(element).closest( 'form' );\n\t\tvar fieldset            = $(element).closest( 'div' ).find( 'fieldset' );\n\t\tvar block_picker        = $(element).closest( 'div' ).find( '.block-picker' );\n\t\tvar selected_block      = block_picker.find( '.selected' );\n\n\t\tvar year_str = fieldset.find( 'input.booking_date_year' ).val();\n\t\tvar year  = parseInt( year_str, 10 );\n\t\tvar month_str = fieldset.find( 'input.booking_date_month' ).val();\n\n\t\tvar month  = parseInt( month_str, 10 );\n\t\tvar day_str = fieldset.find( 'input.booking_date_day' ).val();\n\t\tvar day  = parseInt( day_str, 10 );\n\n\t\tvar date_str =  year_str + '-' + month_str + '-' + day_str;\n\n\t\tif ( ! year || ! month || ! day ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// clear blocks\n\t\tblock_picker.closest( 'div' ).find( 'input' ).val( '' ).trigger( 'change' );\n\t\tblock_picker.closest( 'div' ).block( {message: null, overlayCSS: { background: '#fff', backgroundSize: '16px 16px', opacity: 0.6 }} ).show();\n\t\t$form.find( '.wc-bookings-booking-cost' ).html( '' ).hide();\n\n\t\t// Get blocks via ajax\n\t\tif ( xhr ) xhr.abort();\n\n\t\tvar form_val = $form.serialize();\n\n\t\t/*\n\t\t * Get previous/next day in addition to current day based on server/client timezone offset.\n\t\t * This will give the client enough blocks to fill out 24 hours of blocks in its timezone.\n\t\t */\n\t\tvar server_offset  = get_client_server_timezone_offset_hrs( date_str );\n\t\tif ( server_offset < 0 ) {\n\t\t\tform_val += '&get_next_day=true';\n\t\t} else if ( server_offset > 0 ) {\n\t\t\tform_val += '&get_prev_day=true';\n\t\t}\n\n\t\txhr = $.ajax({\n\t\t\ttype: \t\t'POST',\n\t\t\turl: \t\tbooking_form_params.ajax_url,\n\t\t\tdata: \t\t{\n\t\t\t\taction: 'wc_bookings_get_blocks',\n\t\t\t\tform:   form_val\n\t\t\t},\n\t\t\tsuccess: function( code ) {\n\t\t\t\tblock_picker.html( code );\n\t\t\t\tresize_blocks();\n\t\t\t\toffset_block_times( date_str, $(element) );\n\t\t\t\tblock_picker.closest( 'div' ).unblock();\n\t\t\t\tset_selected_time( block_picker, selected_block.data( 'value' ) );\n\n\t\t\t\t// Hide error notices.\n\t\t\t\t$( '.woocommerce-error.wc-bookings-notice' ).slideUp();\n\t\t\t},\n\t\t\terror: function( jqXHR, exception ) {\n\t\t\t\tif ( 'abort' === exception ) {\n\t\t\t\t\treturn; // Assuming the date is changed very quickly.\n\t\t\t\t}\n\n\t\t\t\tdisplay_error();\n\n\t\t\t\t// Remove loading spin and refresh the datepicker.\n\t\t\t\t$( '.blockOverlay' ).remove();\n\t\t\t\twc_bookings_booking_form.wc_bookings_date_picker.clear_selection();\n\t\t\t\twc_bookings_booking_form.wc_bookings_date_picker.refresh_datepicker();\n\t\t\t},\n\t\t\tdataType: 'html',\n\t\t} );\n\t}\n\n\tfunction resize_blocks() {\n\t\tvar max_width  = 0;\n\t\tvar max_height = 0;\n\n\t\t$('.block-picker a').each( function() {\n\t\t\tvar width  = $(this).width();\n\t\t\tvar height = $(this).height();\n\t\t\tif ( width > max_width ) {\n\t\t\t\tmax_width = width;\n\t\t\t}\n\t\t\tif ( height > max_height ) {\n\t\t\t\tmax_height = height;\n\t\t\t}\n\t\t});\n\n\t\t$('.block-picker a').width( max_width );\n\t\t$('.block-picker a').height( max_height );\n\t}\n\n\tfunction offset_block_times_for_end_time( date_str ) {\n\t\tif ( ! booking_form_params.timezone_conversion ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar from = moment.tz( date_str, local_timezone );\n\t\tvar to = moment( from );\n\t\tvar element = '.block-picker #wc-bookings-form-end-time > option';\n\t\tto.add( 1, 'days' );\n\n\t\t$( element ).each( function() {\n\t\t\tvar block_time = $( this ).data( 'value' );\n\n\t\t\tif ( 'undefined' === typeof block_time || '0' == block_time ) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tvar server_offset = get_client_server_timezone_offset_hrs( date_str );\n\t\t\tvar client_local_time = moment.tz( block_time, booking_form_params.server_timezone );\n\t\t\tvar duration_display = $( this ).data( 'durationDisplay' );\n\n\t\t\tclient_local_time.add( server_offset, 'hours' );\n\n\t\t\t$( this ).text( client_local_time.format( booking_form_params.server_time_format ) + duration_display );\n\t\t} );\n\t}\n\n\tfunction offset_block_times( date_str, element ) {\n\t\tif ( ! booking_form_params.timezone_conversion ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst booking_duration_type = wc_bookings_booking_form.get_booking_duration_type(element);\n\t\tconst booking_duration_unit = wc_bookings_booking_form.get_booking_duration_unit(element);\n\n\t\tvar from = moment.tz( date_str, local_timezone );\n\t\tvar to = moment( from );\n\t\tvar selector = '.block-picker .block a';\n\t\tto.add( 1, 'days' );\n\n\t\tif ( 'customer' === booking_duration_type && ['hour', 'minute'].includes(booking_duration_unit) ) {\n\t\t\tselector = '.block-picker #wc-bookings-form-start-time > option';\n\t\t}\n\n\t\t$( selector ).each( function() {\n\t\t\tif ( '.block-picker #wc-bookings-form-start-time > option' === selector ) {\n\t\t\t\tvar block_time = $( this ).val();\n\t\t\t} else {\n\t\t\t\tvar block_time = $( this ).attr( 'data-value' ); // iso8061 format time string\n\t\t\t}\n\n\t\t\tif ( 'undefined' === typeof block_time || '0' == block_time ) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tvar server_offset = get_client_server_timezone_offset_hrs( date_str );\n\t\t\tvar server_local_time = moment.tz( block_time, booking_form_params.server_timezone );\n\t\t\tvar client_local_time = moment.tz( block_time, booking_form_params.server_timezone );\n\t\t\tclient_local_time.add( server_offset, 'hours' );\n\n\t\t\tif ( ! server_local_time.isBetween( from, to, null, '[)' ) ) {\n\t\t\t\tif ( '.block-picker #wc-bookings-form-start-time > option' === selector ) {\n\t\t\t\t\t// Delete any blocks outside of today.\n\t\t\t\t\t$( this ).remove();\n\t\t\t\t} else {\n\t\t\t\t\t// Delete any blocks outside of today.\n\t\t\t\t\t$( this ).parent().remove();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif ( '.block-picker #wc-bookings-form-start-time > option' === selector ) {\n\t\t\t\t\tconst block_time = moment( $( this ).val() ).unix();\n\t\t\t\t\tconst current_browser_time = moment().unix();\n\n\t\t\t\t\tif ( block_time <= current_browser_time ) {\n\t\t\t\t\t\t// Delete any blocks outside of right now in the past.\n\t\t\t\t\t\t$( this ).remove();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$( this ).text( server_local_time );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t$( this ).text( client_local_time.format( booking_form_params.server_time_format ) );\n\n\t\t\t\t// If the block has existing bookings, show the remaining slots after the time.\n\t\t\t\tif ( $( this ).data( 'remaining' ) ) {\n\t\t\t\t\tif ( '.block-picker #wc-bookings-form-start-time > option' === selector ) {\n\t\t\t\t\t\t$( this ).append( ' (' + $( this ).data( 'remaining' ) + ')' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$( this ).append( ' <small class=\"booking-spaces-left\">(' + $( this ).data( 'remaining' ) + ')</small>' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n} );\n"],"names":["get_client_server_timezone_offset_hrs","referenceDate","booking_form_params","timezone_conversion","reference_time","moment","client_offset","utcOffset","tz","server_timezone","display_error","errorMessage","i18n_request_failed","after","$","removeClass","errorMessageHTML","document","createElement","setAttribute","textContent","insertAfter","slideDown","complete","slideUp","module","exports","window","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","jQuery","ready","xhr","local_timezone","guess","set_selected_time","block_picker","value","submit_button","closest","find","selected_block","data","val","trigger","addClass","time_picker_reset_selected","show_available_time_blocks","element","$form","fieldset","year_str","year","parseInt","month_str","month","day_str","day","date_str","block","message","overlayCSS","background","backgroundSize","opacity","show","html","hide","abort","form_val","serialize","server_offset","ajax","type","url","ajax_url","action","form","success","code","max_width","max_height","each","width","this","height","booking_duration_type","wc_bookings_booking_form","get_booking_duration_type","booking_duration_unit","get_booking_duration_unit","from","to","selector","add","includes","block_time","attr","server_local_time","client_local_time","isBetween","unix","remove","text","format","server_time_format","append","parent","offset_block_times","unblock","error","jqXHR","exception","wc_bookings_date_picker","clear_selection","refresh_datepicker","dataType","replace","on","length","bookingForm","id","parents","blocks","formField","eq","css","resource_id","person_qty","security","nonce","get_end_time_html","start_date_time","product_id","response","replaceWith","duration_display","offset_block_times_for_end_time","duration_unit","show_available_month_blocks","result","JSON","parse","alert"],"sourceRoot":""}