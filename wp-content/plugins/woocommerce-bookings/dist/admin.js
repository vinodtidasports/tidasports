(()=>{"use strict";var jquery__WEBPACK_IMPORTED_MODULE_0__,_wordpress_i18n__WEBPACK_IMPORTED_MODULE_0__,__webpack_modules__={428:module=>{module.exports=window.jQuery},723:module=>{module.exports=window.wp.i18n}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId](module,module.exports,__webpack_require__),module.exports}__webpack_require__.n=module=>{var getter=module&&module.__esModule?()=>module.default:()=>module;return __webpack_require__.d(getter,{a:getter}),getter},__webpack_require__.d=(exports,definition)=>{for(var key in definition)__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)&&Object.defineProperty(exports,key,{enumerable:!0,get:definition[key]})},__webpack_require__.o=(obj,prop)=>Object.prototype.hasOwnProperty.call(obj,prop),(()=>{const external_React_namespaceObject=window.React,external_wp_element_namespaceObject=window.wp.element,external_wp_components_namespaceObject=window.wp.components;var external_jQuery_=__webpack_require__(428),external_jQuery_default=__webpack_require__.n(external_jQuery_);external_jQuery_default()(document).ready((function($){function startEndDateSanitizer(ref){const input=$(ref),dateType=input.closest("div").attr("class"),todaysDate=new Date;let startDate,endDate=null,inputComplement=null;switch(dateType){case"from_date":inputComplement=input.closest("tr").find(".to_date .date-picker"),startDate=input.datepicker("getDate"),endDate=inputComplement.datepicker("getDate"),startDate<todaysDate?input.datepicker("setDate",todaysDate):endDate&&startDate>endDate&&inputComplement.datepicker("setDate",startDate);break;case"to_date":inputComplement=input.closest("tr").find(".from_date .date-picker"),endDate=input.datepicker("getDate"),startDate=inputComplement.datepicker("getDate"),endDate<startDate&&input.datepicker("setDate",startDate)}}function initializeDatepickers(){$("#availability_rows .date-picker, #pricing_rows .date-picker, #rates_rows .date-picker, .booking_start_date_field").datepicker({dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0,showOn:"button",buttonImage:wc_bookings_admin_js_params.calendar_image,buttonImageOnly:!0,minDate:0,firstDay:parseInt(wc_bookings_admin_js_params.start_of_week),onSelect:function(){startEndDateSanitizer(this)},beforeShow:function(input){if($(input).parent().hasClass("to_date")){return{minDate:$(input).closest("tr").find(".from_date .date-picker").datepicker("getDate")}}return{minDate:0}}})}function wc_bookings_trigger_change_events(){$(".wc_booking_availability_type select, .wc_booking_pricing_type select, #_wc_booking_duration_type, #_wc_booking_user_can_cancel, #_wc_booking_duration_unit, #_wc_booking_has_persons, #_wc_booking_has_resources, #_wc_booking_has_person_types, #_wc_booking_has_restricted_days").trigger("change")}$("#bookings_availability, #bookings_pricing, .bookings_extension").on("change",".wc_booking_availability_type select, .wc_booking_pricing_type select",(function(){var value=$(this).val(),tr=$(this).closest("tr"),row=$(tr);row.find(".from_date, .from_day_of_week, .from_month, .from_week, .from_time, .from").hide(),row.find(".to_date, .to_day_of_week, .to_month, .to_week, .to_time, .to").hide(),row.find(".repeating-label").hide(),row.find(".bookings-datetime-select-to").removeClass("bookings-datetime-select-both"),row.find(".bookings-datetime-select-from").removeClass("bookings-datetime-select-both"),row.find(".bookings-to-label-row .bookings-datetimerange-second-label").hide(),row.find(".rrule").hide(),"custom"==value&&row.find(".from_date, .to_date").show(),"custom:daterange"==value&&(row.find(".from_time, .to_time").show(),row.find(".from_date, .to_date").show(),row.find(".bookings-datetime-select-to").addClass("bookings-datetime-select-both"),row.find(".bookings-datetime-select-from").addClass("bookings-datetime-select-both"),row.find(".bookings-to-label-row .bookings-datetimerange-second-label").show()),"months"==value&&row.find(".from_month, .to_month").show(),"weeks"==value&&row.find(".from_week, .to_week").show(),"days"==value&&row.find(".from_day_of_week, .to_day_of_week").show(),value.match("^time")&&(row.find(".from_time, .to_time").show(),"time:range"===value&&(row.find(".from_date, .to_date").show(),row.find(".repeating-label").show(),row.find(".bookings-datetime-select-to").addClass("bookings-datetime-select-both"),row.find(".bookings-datetime-select-from").addClass("bookings-datetime-select-both"),row.find(".bookings-to-label-row .bookings-datetimerange-second-label").show())),"persons"!=value&&"duration"!=value&&"blocks"!=value||row.find(".from, .to").show(),"rrule"===value&&row.find(".rrule").show(),$("#availability_rows tr").show()})),$(document).ready((function(){$("#availability_rows .date-picker, #pricing_rows .date-picker, #rates_rows .date-picker").datepicker("destroy"),initializeDatepickers()})),$("body").on("row_added",(function(){$(".wc_booking_availability_type select, .wc_booking_pricing_type select").trigger("change"),initializeDatepickers()})),$(document).on("change","#availability_rows .date-picker, #pricing_rows .date-picker",(function(){startEndDateSanitizer(this)})),$("body").on("woocommerce-product-type-change",(function(event,type){"booking"!==type&&($("#_wc_booking_has_persons").prop("checked",!1),$("#_wc_booking_has_resources").prop("checked",!1)),wc_bookings_trigger_change_events()})),$("input#_virtual").on("change",(function(){wc_bookings_trigger_change_events()})),$("#_wc_booking_duration_type").on("change",(function(){"customer"==$(this).val()?$("#min_max_duration").show():$("#min_max_duration").hide()})),$("#_wc_booking_duration, #_wc_booking_duration_unit, #_wc_booking_default_date_availability").on("change",(function(){!function(_this){const booking_duration=$("#_wc_booking_duration");if("hour"===$("#_wc_booking_duration_unit").val()&&24<booking_duration.val()&&"non-available"===$("#_wc_booking_default_date_availability").val()){_this.parents(".form-field").addClass("limited-hours");let limited_hours_notice=0!==_this.parents("._wc_booking_default_date_availability_field").length?wc_bookings_admin_js_params.i18n_limited_hours_in_gen_tab:wc_bookings_admin_js_params.i18n_limited_hours;_this.parents(".form-field").addClass("limited-hours").attr("data-note",limited_hours_notice),booking_duration.val(24)}else $(".form-field").removeClass("limited-hours")}($(this))})),$("#_wc_booking_duration_unit").on("change",(function(){switch($(".availability_time, ._wc_booking_first_block_time_field").hide(),$("#enable-range-picker").hide(),$("._wc_booking_apply_adjacent_buffer_field").show(),$("._wc_booking_buffer_period").show(),$(this).val()){case"hour":case"minute":var unit_text="hour"===$(this).val()?wc_bookings_admin_js_params.i18n_hours:wc_bookings_admin_js_params.i18n_minutes;$("._wc_booking_buffer_period_unit").text(unit_text),$(".availability_time, ._wc_booking_first_block_time_field").show();break;case"month":$("#enable-range-picker").show(),$("._wc_booking_buffer_period").hide(),$("._wc_booking_apply_adjacent_buffer_field").hide();break;default:$("#enable-range-picker").show(),$("._wc_booking_buffer_period_unit").text(wc_bookings_admin_js_params.i18n_days)}})),$("#_wc_booking_user_can_cancel").on("change",(function(){$(this).is(":checked")?$(".form-field.booking-cancel-limit").show():$(".form-field.booking-cancel-limit").hide()})),$("#_wc_booking_has_persons").on("change",(function(){$(this).is(":checked")?$("#persons-options, .bookings_persons_tab").show():$("#persons-options, .bookings_persons_tab").hide(),$("ul.wc-tabs li:visible").eq(0).find("a").trigger("click")})),$("#_wc_booking_has_person_types").on("change",(function(){$(this).is(":checked")?$("#persons-types").show():$("#persons-types").hide()})),$("#_wc_booking_has_resources").on("change",(function(){$(this).is(":checked")?($(".bookings_resources_tab").show(),$("._wc_booking_qty_field").addClass("blur").attr("data-note",wc_bookings_admin_js_params.i18n_max_booking_overwridden)):($(".bookings_resources_tab").hide(),$("._wc_booking_qty_field").removeClass("blur")),$("ul.wc-tabs li:visible").eq(0).find("a").trigger("click")})),$("#_wc_booking_has_restricted_days").on("change",(function(){$(this).is(":checked")?$(".booking-day-restriction").show():$(".booking-day-restriction").hide()})),wc_bookings_trigger_change_events(),$("#availability_rows, #pricing_rows").sortable({items:"tr",cursor:"move",axis:"y",handle:".sort",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(event,ui){ui.item.css("background-color","#f6f6f6")},stop:function(event,ui){ui.item.removeAttr("style"),ui.item.show(),external_jQuery_default()(event.target).find("tr").each((function(rowIndex,item){for(var fields=external_jQuery_default()(item).find('[name*="wc_booking"]'),i=0;i<fields.length;i++){var field=fields[i],oldName=external_jQuery_default()(field).attr("name"),newName=oldName.replace(/[\d+]/g,rowIndex);newName!==oldName&&external_jQuery_default()(field).attr("name",newName)}}))}}),$(".add_row").on("click",(function(e){var indexField=$(e.target).closest("table").find("#pricing_rows tr:last [name*=wc_booking_pricing_type]").attr("name"),newRowIndex=indexField?parseInt(indexField.replace(/[^\[]+\[(.*)\]/,"$1"))+1:0,newRow=$(this).data("row");newRow=(newRow=(newRow=(newRow=(newRow=newRow.replace(/bookings_cost_js_index_replace/gi,newRowIndex.toString())).replace(/wc_booking_availability_id.+/,'wc_booking_availability_id[]" value="" />')).replace(/data-id=.+/,'data-id="">')).replace(/wc_booking_availability_title.+/,'wc_booking_availability_title[]" value="" style="border:1px solid #ddd;background-color:#fff;" />')).replace(/wc_booking_availability_priority.+/,'wc_booking_availability_priority[]" value="10" placeholder="10" />');var tableBody=$(this).closest("table").find("tbody");return tableBody.append(newRow),$("body").trigger("row_added",tableBody.find("tr:last")),!1})),$("body").on("click","td.remove",(function(){var row=$(this).parent("tr"),id=row.data("id"),deleted=$(".wc-booking-availability-deleted").val();deleted=deleted+","+id,$(".wc-booking-availability-deleted").val(deleted),row.remove()})),$("#bookings_persons").on("change","input.person_name",(function(){$(this).closest(".woocommerce_booking_person").find("span.person_name").text($(this).val())})),external_jQuery_default()("#bookings_persons").on("click","button.add_person",(function(){external_jQuery_default()(".woocommerce_bookable_persons").block({message:null});var loop=external_jQuery_default()(".woocommerce_booking_person").length,data={action:"woocommerce_add_bookable_person",post_id:wc_bookings_admin_js_params.post,loop,security:wc_bookings_admin_js_params.nonce_add_person};return external_jQuery_default().post(wc_bookings_admin_js_params.ajax_url,data,(function(response){external_jQuery_default()(".woocommerce_bookable_persons").append(response).unblock(),external_jQuery_default()(".woocommerce_bookable_persons #message").hide(),$(".woocommerce_bookable_persons").sortable(persons_sortable_options),$("#_wc_booking_max_persons_group").trigger("change")})),!1})),external_jQuery_default()("#bookings_persons").on("click","button.unlink_booking_person",(function(e){if(e.preventDefault(),confirm(wc_bookings_admin_js_params.i18n_remove_person)){var el=external_jQuery_default()(this).parent().parent(),person=external_jQuery_default()(this).attr("rel");if(person>0){external_jQuery_default()(el).block({message:null});var data={action:"woocommerce_unlink_bookable_person",person_id:person,security:wc_bookings_admin_js_params.nonce_unlink_person};external_jQuery_default().post(wc_bookings_admin_js_params.ajax_url,data,(function(response){external_jQuery_default()(el).fadeOut("300",(function(){external_jQuery_default()(el).remove()}))}))}else external_jQuery_default()(el).fadeOut("300",(function(){external_jQuery_default()(el).remove()}))}return!1}));var persons_sortable_options={items:".woocommerce_booking_person",cursor:"move",axis:"y",handle:"h3",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(event,ui){ui.item.css("background-color","#f6f6f6")},stop:function(event,ui){ui.item.removeAttr("style"),$(".woocommerce_bookable_persons .woocommerce_booking_person").each((function(index,el){$(".person_menu_order",el).val(parseInt($(el).index(".woocommerce_bookable_persons .woocommerce_booking_person"),10))}))}};$(".woocommerce_bookable_persons").sortable(persons_sortable_options),$("#bookings_resources").on("change","input.resource_name",(function(){$(this).closest(".woocommerce_booking_resource").find("span.resource_name").text($(this).val())})),external_jQuery_default()("#bookings_resources").on("click","button.add_resource",(function(){var loop=external_jQuery_default()(".woocommerce_booking_resource").length,add_resource_id=external_jQuery_default()("select.add_resource_id").val(),add_resource_name="";if(!add_resource_id&&!(add_resource_name=prompt(wc_bookings_admin_js_params.i18n_new_resource_name)))return!1;external_jQuery_default()(".woocommerce_bookable_resources").block({message:null});var data={action:"woocommerce_add_bookable_resource",post_id:wc_bookings_admin_js_params.post,loop,add_resource_id,add_resource_name,security:wc_bookings_admin_js_params.nonce_add_resource};return external_jQuery_default().post(wc_bookings_admin_js_params.ajax_url,data,(function(response){response.error?alert(response.error):(external_jQuery_default()(".woocommerce_bookable_resources").append(response.html).unblock(),external_jQuery_default()(".woocommerce_bookable_resources").sortable(resources_sortable_options),add_resource_id&&external_jQuery_default()(".add_resource_id").find("option[value="+add_resource_id+"]").remove())})),!1})),external_jQuery_default()("#bookings_resources").on("click","button.remove_booking_resource",(function(e){if(e.preventDefault(),confirm(wc_bookings_admin_js_params.i18n_remove_resource)){var el=external_jQuery_default()(this).parent().parent(),resource=external_jQuery_default()(this).attr("rel");external_jQuery_default()(el).block({message:null,overlayCSS:{background:"#fff url("+wc_bookings_admin_js_params.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var data={action:"woocommerce_remove_bookable_resource",post_id:wc_bookings_admin_js_params.post,resource_id:resource,security:wc_bookings_admin_js_params.nonce_delete_resource};external_jQuery_default().post(wc_bookings_admin_js_params.ajax_url,data,(function(response){external_jQuery_default()(el).fadeOut("300",(function(){external_jQuery_default()(el).remove();var resource_id=external_jQuery_default()(el).find("input[name*=resource_id]").val(),resource_title=external_jQuery_default()(el).find("input[name*=resource_title]").val();external_jQuery_default()("select[name=add_resource_id]").append(external_jQuery_default()("<option>",{value:resource_id,text:resource_title}))}))}))}return!1}));var resources_sortable_options={items:".woocommerce_booking_resource",cursor:"move",axis:"y",handle:"h3",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(event,ui){ui.item.css("background-color","#f6f6f6")},stop:function(event,ui){ui.item.removeAttr("style"),$(".woocommerce_bookable_resources .woocommerce_booking_resource").each((function(index,el){$(".resource_menu_order",el).val(parseInt($(el).index(".woocommerce_bookable_resources .woocommerce_booking_resource"),10))}))}};function renderWPTimePicker(el){const timeElement=el.querySelector('input[type="time"]'),timeIn24Hours=timeElement.value?timeElement.value.split(":"):["00","00"],currentTime=new Date;currentTime.setHours(timeIn24Hours[0]),currentTime.setMinutes(timeIn24Hours[1]);let setTimeAsValueToInputField=(timeFieldContainer,time)=>{const date=new Date(time),hours=date.getHours().toString().padStart(2,"0"),minutes=date.getMinutes().toString().padStart(2,"0");timeFieldContainer.querySelector("input:last-child").value=`${hours}:${minutes}`};setTimeAsValueToInputField=setTimeAsValueToInputField.bind(null,el),(0,external_wp_element_namespaceObject.render)((0,external_React_namespaceObject.createElement)(external_wp_components_namespaceObject.TimePicker,{currentTime,is12Hour:"1"===wc_bookings_admin_js_params.time_in_12hours,onChange:setTimeAsValueToInputField,__nextRemoveHelpButton:!0,__nextRemoveResetButton:!0}),el),el.insertAdjacentHTML("beforeend",`<input type="hidden" name="${timeElement.name}" value="${timeElement.value}" />`)}$(".woocommerce_bookable_resources").sortable(resources_sortable_options),$("#bookings_persons").on("change","#_wc_booking_max_persons_group",(function(){const max_persons_group=$(this).val();max_persons_group&&max_persons_group>0?$(".woocommerce_bookable_persons").find("input.person_max, input.person_min").each((function(){$(this).attr("max",max_persons_group)})):$(".woocommerce_bookable_persons").find("input.person_max, input.person_min").each((function(){$(this).removeAttr("max")}))})),$("#_wc_booking_max_persons_group").trigger("change"),document.querySelectorAll(["#availability_rows tr:not(.google-event) .from_time","#availability_rows tr:not(.google-event) .to_time","#pricing_rows .from_time","#pricing_rows .to_time"].join(", ")).forEach((el=>{renderWPTimePicker(el)})),$("body").on("row_added",(function(e,jQueryRowSelector){jQueryRowSelector.classList.contains("google-event")||(jQueryRowSelector.closest("#availability_rows")||jQueryRowSelector.closest("#pricing_rows"))&&jQueryRowSelector.querySelectorAll(".from_time, .to_time").forEach((el=>{renderWPTimePicker(el)}))}))}))})(),jquery__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(428),__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_0__)()((function($){if("undefined"!==window.wcTracks){var wc_bookings_tracks={record_event:function(eventName,properties){let baseProperties={bookings_version:wc_bookings_admin_js_params.bookings_version,bookings_db_version:wc_bookings_admin_js_params.bookings_db_version};properties={...properties,...baseProperties};const fullEventName="bookings_"+eventName;window.wcTracks.recordEvent(fullEventName,properties)},init:function(){var doc=$(document);doc.on("click",".booking-calendar-booking-title, .booking-calendar-time-range",(function(){wc_bookings_tracks.record_event("calendar_popover_clicked")})),doc.on("click","#wc-bookings-datepicker-toggle-day",(function(){wc_bookings_tracks.record_event("calendar_datepicker_clicked")})),doc.on("click",".wc-bookings-datepicker-popover .CalendarDay",(function(){wc_bookings_tracks.record_event("calendar_datepicker_date_changed")})),doc.on("click",".date-selector-popover .change-date.prev",(function(){wc_bookings_tracks.record_event("calendar_change_date_prev_clicked")})),doc.on("click",".date-selector-popover .change-date.next",(function(){wc_bookings_tracks.record_event("calendar_change_date_next_clicked")})),doc.on("click",".date-selector-popover .change-date.today",(function(){wc_bookings_tracks.record_event("calendar_change_date_today_clicked")})),doc.on("click",".wc-bookings-calendar-popover #event_detail_footer a",(function(){wc_bookings_tracks.record_event("calendar_popover_details_clicked")})),doc.on("click","#publish",(function(){-1<window.location.href.indexOf("post-new.php")&&"booking"===$("#product-type").val()&&wc_bookings_tracks.record_event("booking_product_published")})),doc.on("wc_bookings_template_clicked",(function(event,templateIndex,templateSlug){wc_bookings_tracks.record_event("template_click",{product_template:templateSlug,source:window.pagenow||"unknown"})})),doc.on("click",".bookings-templates a.start-from-scratch-link",(function(){wc_bookings_tracks.record_event("template_click_blank")}))}};wc_bookings_tracks.init()}})),_wordpress_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(723),document.addEventListener("DOMContentLoaded",(function(){const form=document.getElementById("bookings_settings"),lazyLoadAvailabilityRuleshiddenField=form?form.querySelector('[name="can-lazy-load-availability-rules"]'):null;if(!lazyLoadAvailabilityRuleshiddenField||!parseInt(lazyLoadAvailabilityRuleshiddenField.value))return;const availability_rule_types={current_list_type:new URLSearchParams(window.location.search).get("show"),GOOGLE_EVENT:"google-events",AVAILABILITY_RULES:"availability-rules"},availability_rule={remaining_availability_rules:{button:null,can_fetch:!0,next_request_data:{},availability_rules_html:""},init_lazy_load:()=>{if(availability_rule_types.GOOGLE_EVENT!==availability_rule_types.current_list_type)return;const data={per_page:parseInt(form.querySelector('[name="availability-rules-per-page"]').value),step:1,nonce:form.querySelector('[name="lazy_load_availability_rules_nonce"]').value,show:availability_rule_types.current_list_type};availability_rule.register_lazy_load_button(),availability_rule.remaining_availability_rules.button.disabled=!0,availability_rule.fetch(data)},insert_html:html=>{const availability_rows=document.getElementById("availability_rows");availability_rows.insertAdjacentHTML("beforeend",html),jQuery("body").trigger("row_added",availability_rows.querySelector("tr:last-child"))},register_lazy_load_button:()=>{const submit_button_container=form.querySelector("p.submit"),button_title=(0,_wordpress_i18n__WEBPACK_IMPORTED_MODULE_0__.__)("Load more Google Calendar event rules","woocommerce-bookings");submit_button_container.insertAdjacentHTML("beforeend",`<button class="button-secondary lazy-load-button" style="margin-left: 5px">${button_title}</button>`),availability_rule.remaining_availability_rules.button=submit_button_container.querySelector(".lazy-load-button"),availability_rule.remaining_availability_rules.button.addEventListener("click",(event=>{const{button,can_fetch,next_request_data,availability_rules_html}=availability_rule.remaining_availability_rules;button.disabled=!0,button.textContent=(0,_wordpress_i18n__WEBPACK_IMPORTED_MODULE_0__.__)("Loading...","woocommerce-bookings"),window.setTimeout((()=>{availability_rule.insert_html(availability_rules_html)}),5),can_fetch&&window.setTimeout((()=>availability_rule.fetch(next_request_data)),10),event.preventDefault()}))},fetch:(data=null)=>{const request={method:"POST"},form_data=new FormData;data.action="wc_bookings_lazy_load_availability_rules";for(const property in data)form_data.append(property,data[property]);request.body=form_data,fetch(`${wc_bookings_admin_js_params.ajax_url}`,request).then((response=>response.json())).then((response=>{if(response.success){const{button}=availability_rule.remaining_availability_rules;if(!response.data.lazy_load_availability_rules)return availability_rule.insert_html(response.data.html),void button.remove();++data.step,availability_rule.remaining_availability_rules.availability_rules_html=response.data.html,availability_rule.remaining_availability_rules.can_fetch=response.data.lazy_load_availability_rules,availability_rule.remaining_availability_rules.next_request_data=data,button.disabled=!1,button.textContent=(0,_wordpress_i18n__WEBPACK_IMPORTED_MODULE_0__.__)("Load more Google Calendar event rules","woocommerce-bookings")}}))}};availability_rule.init_lazy_load()})),(()=>{var _wordpress_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(723),jquery__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(428);__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_1__)()((function($){$(".wc-use-templates").on("click",(function(e){e.preventDefault();const button=$(this),dashicon=button.find(".dashicons"),template=button.parents(".template-loop-item"),dataIndex=template.data("template-index"),dataSlug=template.data("template-slug");if(button.hasClass("active"))return!1;button.addClass("active"),dashicon.addClass("dashicons-update"),dashicon.addClass("spin"),dashicon.css("display","inline-block"),$.ajax({type:"POST",url:wc_bookings_admin_js_params.ajax_url,data:{action:"wc_bookings_get_product_template",index:dataIndex,slug:dataSlug,security:wc_bookings_admin_js_params.nonce.wc_bookings_get_product_template},success:function(result){if(result=JSON.parse(result),button.removeClass("active"),dashicon.removeClass("dashicons-update"),dashicon.css("display","none"),!result.success)return alert(result.data),!1;if(0===$(".template-item-popup-content .insertion-result").length){const paragraph=document.createElement("p");paragraph.className="insertion-result",paragraph.innerHTML=(0,_wordpress_i18n__WEBPACK_IMPORTED_MODULE_0__.sprintf)((0,_wordpress_i18n__WEBPACK_IMPORTED_MODULE_0__.__)("A bookable product is created using this template. Please %1$sclick here%2$s if you are not redirected automatically.","woocommerce-bookings"),`<a href="${result.data}">`,"</a>"),$(".template-item-popup-content").append(paragraph)}window.location.href=result.data},error:function(jqXHR,exception){"abort"!==exception&&(alert(jqXHR.responseText),button.removeClass("active"),dashicon.removeClass("dashicons-update"))},dataType:"html"})})),$(".template-loop-item").on("click",(function(e){e.stopPropagation();const $body=$("body");if(0!==$(e.target).closest(".item-popup-arrow").length||0!==$(e.target).closest(".template-item-popup-inner").length)return!1;$("#active-template-popup-overlay").length||$body.prepend('<div id="active-template-popup-overlay"></div>'),$body.addClass("noscroll"),$(".template-item-popup").fadeOut(),$(this).find(".template-item-popup").addClass("active").fadeIn(),$body.trigger("wc_bookings_template_clicked",[$(this).data("template-index"),$(this).data("template-slug"),$(this)])})),$(".close-template-popup").on("click",(function(e){e.stopPropagation(),$(".template-item-popup").fadeOut(),$(this).parents(".template-item-popup").removeClass("active"),$("#active-template-popup-overlay").remove(),$("body").removeClass("noscroll")})),$(document).on("click",(function(e){0===$(e.target).closest(".template-item-popup-inner").length&&$(".close-template-popup").trigger("click")})),$(document).on("keyup",(function(e){const activePopupEl=$(".active.template-item-popup");if(activePopupEl.length)switch(e.key){case"ArrowLeft":activePopupEl.find(".item-popup-arrow.left").trigger("click");break;case"ArrowRight":activePopupEl.find(".item-popup-arrow.right").trigger("click");break;case"Escape":activePopupEl.find(".close-template-popup").trigger("click")}})),$(".item-popup-arrow").on("click",(function(){const direction=$(this).hasClass("left")?"left":"right",currentPopupCard=$(this).closest(".template-loop-item");if(currentPopupCard.find(".template-item-popup").removeClass("active"),"left"===direction){let prevPopupCard=currentPopupCard.prev();prevPopupCard=prevPopupCard.length?prevPopupCard:currentPopupCard.siblings().last(),prevPopupCard.trigger("click")}else{let nextPopupCard=currentPopupCard.next();nextPopupCard=nextPopupCard.length?nextPopupCard:currentPopupCard.siblings().first(),nextPopupCard.trigger("click")}}))}))})()})();
//# sourceMappingURL=admin.js.map